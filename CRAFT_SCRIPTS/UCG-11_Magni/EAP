@variables{
    * Abreviated names for blocks
    AIVE = "Air Vent Fan"
    ANTE = "Antenna"
    BATT = "Battery"
    BEAC = "Beacon"
    COMA = "Connector Main"
    EVC2 = "Event Controller - Connect"
    EXPI = "Exhaust Pipe"
    GATU = "Gatling Turret"
    GYRO = "Gyroscope"
    HELI = "Headlight"
    HLL1 = "Hinge Landing Leg 1"
    HYEN = "Hydrogen Engine"
    HYTA = "Hydrogen Tank"
    LCIN = "LCD Info"
    LIGH = "Light"
    LIPA = "Light Panel Floor"
    LIST = "Light Status"
    O2H2 = "O2/H2 Generator"
    ORDE = "Ore Detector"
    PAHA = "Parachute Hatch"
    PRPA = "Program [PAM]"
    PIJA = "Piston Jack"
    ROAR = "Rotor Arm"
    ROLI = "Rotating Light"
    SPLI = "Spotlight"
    THRU = "Thruster"
    TISH = "Timer Shutdown"
    TIST = "Timer Standby"
    HILA = "Hinge Landing"
    HIL1 = "Hinge Landing One"
    HIL2 = "Hinge Landing Two"
    PILA = "Piston Landing"
    MALO = "Maglock" 
}

@low_alt{
    * Triggered by Event Controller checking Altitude
    OnOff_On \LIPA
    Write to \LCIN = "LOW ALTITUDE"
    Rotate \HIL1 to -30 at -3
    Delay 1000
    Rotate \HIL2 to -60 at -6
    Move \PILA to 1 at 1
}

@high_alt{
    * Triggered by Event Controller checking Altitude
    OnOff_Off \LIPA
    Rotate \HILA to -85 at 1
    Write to \LCIN = "HIGH ALTITUDE"
}

@land{
    * Triggered by Event Controller checking if Maglock ready to lock
    Delay 3000
    if UCA-11 Maglock BL = READY TO LOCK {
        Lock \MALO
        @runmode
    }
}

@runmode {
    if Color of \LIST = 255:0:0
    {
        @offlinetostandby
    }
    else if Color of \LIST = 255:255:0
    {
        @standbytoonline
    }
    else if Color of \LIST = 255:255:255
    {
        @onlinetostandby
    }
    else if Color of \LIST = 255:255:50
    {
        @standbytooffline
    }
}

@offlinetostandby {
    Color of \LIST = 255:255:0
    Write to \LCIN = Standby
    OnOff_On \ANTE
    OnOff_On \GATU
    OnOff_On \LIPA
    OnOff_On \LIST
    OnOff_On \O2H2
    OnOff_Off \ORDE
    OnOff_On \ROAR
    OnOff_Off \AIVE
    OnOff_Off \EXPI
    OnOff_Off \HYEN
    OnOff_Off \HELI
    OnOff_Off \SPLI
    Stop \TIST
    Stop \TISH
}

@standbytoonline {
    Color of \LIST = 255:255:255
    Write to \LCIN = Active
    OnOff_On \AIVE
    OnOff_On \EXPI
    OnOff_On \HYEN
    OnOff_On \HELI
    OnOff_On \ORDE
    OnOff_On \LIPA
    Stop \TIST
    Stop \TISH
    Stockpile of \HYTA = False
    Discharge \BATT
    Unlock \COMA
    Delay 5000
    OnOff_On \EVC2
}

@onlinetostandby {
    Color of \LIST = 255:255:50
    Write to \LCIN = Standby
    OnOff_On \ANTE
    OnOff_On \GATU
    OnOff_Off \LIPA
    OnOff_On \LIST
    OnOff_On \O2H2
    OnOff_Off \ORDE
    OnOff_On \ROAR
    OnOff_Off \AIVE
    OnOff_Off \EXPI
    OnOff_Off \HYEN
    OnOff_Off \HELI
    OnOff_Off \SPLI
    Start \TISH
}

@standbytooffline {
    Color of \LIST = 255:0:0
    Write to \LCIN = Powered Down
    OnOff_Off \ANTE
    OnOff_Off \AIVE
    OnOff_Off \EXPI
    OnOff_Off \GATU
    OnOff_Off \HYEN
    OnOff_Off \LIST
    OnOff_Off \HELI
    OnOff_Off \SPLI
    OnOff_Off \O2H2
    OnOff_Off \ROLI
    OnOff_Off \ROAR
}